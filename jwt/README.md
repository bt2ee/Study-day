## JWT
#### å®šä¹‰
jwt æ˜¯ json web token çš„å…¨ç§°ã€‚
ä¼˜ç‚¹æ˜¯æœåŠ¡å™¨ä¸ä¿å­˜ä»»ä½•ä¼šè¯æ•°æ®ï¼Œå³æœåŠ¡å™¨å˜ä¸ºæ— çŠ¶æ€ï¼Œä½¿å…¶æ›´å®¹æ˜“æ‰©å±•ã€‚è½»ä¾¿ï¼Œå¼€é”€å°ã€‚

#### åŸç†
æœåŠ¡å™¨è®¤è¯ä»¥åï¼Œç”Ÿæˆä¸€ä¸ª JSON å¯¹è±¡ï¼Œå‘æŒ¥ç»™ç”¨æˆ·ï¼ŒæœåŠ¡å™¨é ç€è¿™ä¸ªå¯¹è±¡è®¤å®šç”¨æˆ·èº«ä»½ï¼Œä¸ºäº†é˜²æ­¢ç¯¡æ”¹ï¼ŒæœåŠ¡å™¨ç”Ÿæˆå¯¹è±¡æ—¶ï¼Œä¼šåŠ ä¸Šç­¾å

#### è®¤è¯æµç¨‹
- æµè§ˆå™¨å‘èµ·è¯·æ±‚ç™»é™†ï¼Œæºå¸¦ç”¨æˆ·åå’Œå¯†ç ï¼›
- æœåŠ¡ç«¯æ ¹æ®ç”¨æˆ·åå’Œæ˜ç åˆ°æ•°æ®åº“éªŒè¯èº«ä»½ï¼Œæ ¹æ®ç®—æ³•ï¼Œå°†ç”¨æˆ·æ ‡è¯†ç¬¦æ‰“åŒ…ç”Ÿæˆ token,
- æœåŠ¡å™¨è¿”å›JWTä¿¡æ¯ç»™æµè§ˆå™¨ï¼ŒJWTä¸åº”è¯¥åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œè¿™æ˜¯å¾ˆé‡è¦çš„ä¸€ç‚¹
- æµè§ˆå™¨å‘èµ·è¯·æ±‚è·å–ç”¨æˆ·èµ„æ–™ï¼ŒæŠŠåˆšåˆšæ‹¿åˆ°çš„ tokenä¸€èµ·å‘é€ç»™æœåŠ¡å™¨ï¼Œä¸€èˆ¬æ”¾åœ¨headeré‡Œé¢ï¼Œå­—æ®µä¸ºauthorization
- æœåŠ¡å™¨å‘ç°æ•°æ®ä¸­æœ‰ tokenï¼Œdecode tokençš„ä¿¡æ¯ï¼Œç„¶åå†æ¬¡ç­¾åï¼ŒéªŒæ˜æ­£èº«ï¼›
- æœåŠ¡å™¨è¿”å›è¯¥ç”¨æˆ·çš„ç”¨æˆ·èµ„æ–™ï¼›
- æœåŠ¡å™¨å¯ä»¥åœ¨payloadè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œ å¦‚æœè¿‡æœŸäº†ï¼Œå¯ä»¥è®©å®¢æˆ·ç«¯é‡æ–°å‘èµ·éªŒè¯ã€‚

#### jwt çš„æ•°æ®ç»“æ„
**Header å¤´éƒ¨**
```
{ "alg": "HS256", "typ": "JWT"}
// algorithm => HMAC SHA256
// type => JWT
```

è¿™æ˜¯å›ºå®šçš„å†™æ³•ï¼Œalg è¦ç”¨çš„æ˜¯ HS256 ç®—æ³•

**Payload è´Ÿè½½**
Payload è´Ÿè½½ï¼Œè§„å®šäº†ä¸ƒä¸ªå­—æ®µ
```
iss (issuer)ï¼šç­¾å‘äºº
exp (expiration time)ï¼šè¿‡æœŸæ—¶é—´
sub (subject)ï¼šä¸»é¢˜
aud (audience)ï¼šå—ä¼—
nbf (Not Before)ï¼šç”Ÿæ•ˆæ—¶é—´
iat (Issued At)ï¼šç­¾å‘æ—¶é—´
jti (JWT ID)ï¼šç¼–å·
```

**Signature ç­¾å**
å¯¹å‰ä¸¤éƒ¨åˆ† header å’Œ payload è¿›è¡Œç­¾åï¼Œé˜²æ­¢æ•°æ®ç¯¡æ”¹

```
HMACSHA256(base64UrlEncode(header) + '.' + base64UrlEncode(payload), secret)
```

secret æ˜¯ä¸€æ®µå­—ç¬¦ä¸²ï¼Œåç«¯ä¿å­˜ï¼Œæœ‰äº›åœºåˆä¼šæ”¾åˆ° url ä¸­ã€‚

Base64 æœ‰ä¸‰ä¸ªè‡ªè´Ÿ +ã€/ã€= åœ¨ url ä¸­æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œæ‰€ä»¥ä¼šè¢«æ›¿æ¢æ‰ï¼Œ= è¢«çœç•¥ï¼Œ+ æ›¿æ¢æˆ -ï¼Œ/ æ›¿æ¢æˆ _ã€‚

#### ä½¿ç”¨æ–¹å¼
HTTP è¯·æ±‚å¤´ä¿¡æ¯ Authorization å­—æ®µä¸­ï¼Œ Bearer ä¹Ÿæ˜¯è§„å®šå¥½çš„
```
Authorization: Bearer <token>
```
> ä¸å»ºè®®æ”¾å…¥ url ä¸­ï¼Œé˜²æ­¢ csrf æ”»å‡»

#### ä½¿ç”¨
ğŸ‘‰ [demo](./demo/index.js)
